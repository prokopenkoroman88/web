<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title></title>
	<link rel="stylesheet" href="../css/style.css">
</head>
<body>

<!--
<h1 class="h1">
	<div class="en">
		
	</div>
	<div class="ru">
		
	</div>
</h1>


<div class="p">
	<div class="en">
		
	</div>
	<div class="ru">
		
	</div>
</div>



<h2 class="h2">
	<div class="en">
		
	</div>
	<div class="ru">
		
	</div>
</h2>

<div class="p">
	<div class="en">
		
	</div>
	<div class="ru">
		
	</div>
</div>


-->

<a href="https://www.jetbrains.com/help/phpstorm/remote-debugging-via-ssh-tunnel.html">Оригинал</a>
<!--
<h1 class="h1">
	<div class="en">
		A Module in Magento 2
	</div>
	<div class="ru">
		Модули в Magento 2
	</div>
</h1>
-->


<div class="h1"><div class="en">Remote debugging via SSH tunnel﻿</div><div class="ru">Удаленная отладка через SSH-туннель</div></div>
<div class="p"><div class="en">Last modified: 08 March 2021</div><div class="ru">Последнее изменение: 8 марта 2021 г.</div></div><div class="p"><div class="en">This tutorial describes how to use an SSH tunnel to setup a secure connection between the development machine and a remote server. This can be useful for debugging code on a remote machine when there are firewalls in between, or a NAT router prevents direct connection, or the ISP or network infrastructure does not allow incoming TCP connections to the developer machine.</div><div class="ru">В этом руководстве описывается, как использовать туннель SSH для установки безопасного соединения между машиной разработки и удаленным сервером. Это может быть полезно для отладки кода на удаленном компьютере, когда между ними установлены брандмауэры, или маршрутизатор NAT предотвращает прямое соединение, или интернет-провайдер или сетевая инфраструктура не разрешают входящие TCP-соединения с машиной разработчика.</div></div><div class="h2"><div class="en">Prepare the debugging engine﻿</div><div class="ru">Подготовьте движок отладки</div></div><div class="p"><div class="en">Before you start debugging, make sure that you have a debugging engine installed and configured properly. PhpStorm supports debugging with two most popular tools: Xdebug and Zend Debugger. These tools cannot be used simultaneously because they block each other. To avoid this problem, you need to update the corresponding sections in the php.ini file as described in Configure Xdebug and Configure Zend Debugger.</div><div class="ru">Перед тем, как начать отладку, убедитесь, что у вас установлен и правильно настроен механизм отладки. PhpStorm поддерживает отладку с помощью двух самых популярных инструментов: Xdebug и Zend Debugger. Эти инструменты нельзя использовать одновременно, потому что они блокируют друг друга. Чтобы избежать этой проблемы, вам необходимо обновить соответствующие разделы в файле php.ini, как описано в разделах «Настройка Xdebug» и «Настройка Zend Debugger».</div></div><div class="h2"><div class="en">Open the active php.ini file in the editor:</div><div class="ru">Откройте в редакторе активный файл php.ini:</div></div><div class="h2"><div class="en">In the Settings/Preferences dialog Ctrl+Alt+S, click PHP.</div><div class="ru">В диалоговом окне «Настройки / Предпочтения» Ctrl + Alt + S щелкните PHP.</div></div><div class="h2"><div class="en">On the PHP page that opens, click the Browse button next to the CLI Interpreter field.</div><div class="ru">На открывшейся странице PHP нажмите кнопку «Обзор» рядом с полем «Интерпретатор интерфейса командной строки».</div></div><div class="h2"><div class="en">In the CLI Interpreters dialog that opens, the Configuration file read-only field shows the path to the active php.ini file. Click Open in Editor.</div><div class="ru">В открывшемся диалоговом окне «Интерпретаторы интерфейса командной строки» в поле «Файл конфигурации», доступном только для чтения, отображается путь к активному файлу php.ini. Щелкните Открыть в редакторе.</div></div><div class="h2"><div class="en">When using Xdebug, make sure at least the following settings are specified:</div><div class="ru">При использовании Xdebug убедитесь, что указаны как минимум следующие параметры:</div></div>

<h3>XDebug2</h3>
<pre>
[
xdebug
]

zend_extension="<path to xdebug extension>"
xdebug.remote_enable=1
xdebug.remote_host=127.0.0.1
xdebug.remote_port="<the port (9000 by default) to which Xdebug connects>"
</pre>

<h3>XDebug3</h3>
<pre>
[
xdebug
]

zend_extension="<path to xdebug extension>"
xdebug.mode=debug
xdebug.client_host=127.0.0.1
xdebug.client_port="<the port (9003 by default) to which Xdebug connects>"
</pre>





<div class="h2"><div class="en">Listening for incoming debugger connections﻿</div><div class="ru">Прослушивание входящих соединений отладчика</div></div>
<div class="p"><div class="en">In PhpStorm, enable listening to incoming debug connections by either clicking the Start Listening for PHP Debug Connections button on the toolbar or selecting Run | Start Listening for PHP Debug Connections in the main menu. This will ensure PhpStorm reacts when a debugging session is started and opens the Debug tool window automatically. Before launching the script, make sure that either a breakpoint is set or the Break at first line in PHP scripts option is enabled on the Debug page of the Settings/Preferences dialog Ctrl+Alt+S.</div><div class="ru">В PhpStorm включите прослушивание входящих отладочных подключений, нажав кнопку «Начать прослушивание подключений отладки PHP» на панели инструментов или выбрав «Выполнить» | Начните прослушивание подключений отладки PHP в главном меню. Это гарантирует, что PhpStorm среагирует при запуске сеанса отладки и автоматически откроет окно инструмента отладки. Перед запуском сценария убедитесь, что либо установлена ​​точка останова, либо включен параметр «Прервать первую строку в сценариях PHP» на странице «Отладка» диалогового окна «Параметры / Параметры» Ctrl + Alt + S.</div></div>
<div class="h2"><div class="en">Set up an SSH tunnel to the remote machine﻿</div><div class="ru">Настроить SSH-туннель к удаленному компьютеру</div></div>
<div class="p"><div class="en">What we want to do is connect to the remote machine over SSH and set up port forwarding for port 9000 (for Xdebug 2), 9003 (for Xdebug 3), or 10137 (Zend Debugger). The idea is to create a "virtual" TCP port on the remote server that sends its traffic to a TCP port on our own machine, tunneling traffic over SSH.</div><div class="ru">Что мы хотим сделать, так это подключиться к удаленному компьютеру через SSH и настроить переадресацию портов для порта 9000 (для Xdebug 2), 9003 (для Xdebug 3) или 10137 (Zend Debugger). Идея состоит в том, чтобы создать «виртуальный» TCP-порт на удаленном сервере, который отправляет свой трафик на TCP-порт на нашей собственной машине, туннелируя трафик через SSH.</div></div>


<div class="img">
	<img src="../images/remote-debugging-via-ssh-tunnel/ssh-tunnel-explained.png" alt="">
</div>


<div class="h2"><div class="en">SSH tunnel diagram</div><div class="ru">Схема туннеля SSH</div></div>
<div class="p"><div class="en">The SSH tunnel is used for connecting through a firewall and establishing a secure connection between the remote server and the developer machine. When the remote server can connect to the developer machine directly (for example, with a Vagrant machine), an SSH tunnel may not be needed.</div><div class="ru">Туннель SSH используется для подключения через брандмауэр и установления безопасного соединения между удаленным сервером и машиной разработчика. Когда удаленный сервер может напрямую подключаться к машине разработчика (например, с машиной Vagrant), туннель SSH может не понадобиться.</div></div>
<div class="p"><div class="en">In this case, we need to make the debugger connect back to the developer machine by setting xdebug.remote_host=ip_address (for Xdebug 2), xdebug.client_host=ip_address (for Xdebug 3) or making sure the debug host is the IP address of the developer machine (for Zend Debugger). This can be done using the PhpStorm bookmarklets, a Browser Debugging Extension, or the techniques outlined in Debugging PHP CLI scripts with PhpStorm.</div><div class="ru">В этом случае нам нужно заставить отладчик подключиться обратно к машине разработчика, установив xdebug.remote_host = ip_address (для Xdebug 2), xdebug.client_host = ip_address (для Xdebug 3) или убедившись, что хост отладки является IP-адресом машина разработчика (для Zend Debugger). Это можно сделать с помощью букмарклетов PhpStorm, расширения отладки браузера или методов, описанных в разделе «Отладка сценариев PHP CLI с помощью PhpStorm».</div></div>
<div class="p"><div class="en">The setup process depends on the operating system and the debugger being used.</div><div class="ru">Процесс установки зависит от операционной системы и используемого отладчика.</div>
















<a href=".\.html">PREV</a>
<a href=".\.html">NEXT</a>

	<script src="../js/script.js"></script>
</body>
</html>